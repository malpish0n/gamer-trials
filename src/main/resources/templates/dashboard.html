<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>GamerTrials ‚Äî Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="icon" type="image/png" href="/img/logo-gt.png">
    <style>
        /* Scoped styles for the edit profile form to avoid leaking to whole page */
        .profile-edit{display:flex;flex-direction:column;gap:16px;margin-bottom:4px}
        .profile-edit .input-group{display:flex;flex-direction:column;text-align:left}
        .profile-edit .input-group label{font-weight:600;font-size:.9rem;color:var(--muted);margin-bottom:6px}
        .profile-edit .input-group input[type="text"],
        .profile-edit .input-group input[type="date"],
        .profile-edit .input-group textarea{padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0e1012;color:var(--text);font-size:.95rem}
        .profile-edit .input-group textarea{min-height:90px}
        .profile-edit .input-group input:focus,
        .profile-edit .input-group textarea:focus{outline:none;border-color:var(--accent)}
    </style>
</head>

<body>
<div th:replace="fragments/header :: siteHeader"></div>

<section class="gt-section">
    <div class="gt-container" style="display:grid;grid-template-columns:320px 1fr;gap:24px;align-items:start">

        <!-- Left column -->
        <aside class="card" style="background:var(--card);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)">
            <div style="text-align:center">
                <div style="width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:800;color:#0b0c0d;font-size:28px;margin:0 auto 12px"
                     th:text="${#strings.substring(username,0,1)?.toUpperCase()}">U</div>
                <div style="font-weight:700;font-size:20px;margin-bottom:4px" th:text="${username}">User</div>
                <div style="color:var(--muted);font-size:13px" th:text="${#authentication.principal?.authorities}">ROLE_USER</div>
            </div>

            <div style="margin-top:22px">
                <div style="font-weight:700;margin-bottom:10px">Badges</div>
                <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:10px">
                    <div style="height:56px;border-radius:12px;background:var(--card-2);display:flex;align-items:center;justify-content:center">üèÜ</div>
                    <div style="height:56px;border-radius:12px;background:var(--card-2);display:flex;align-items:center;justify-content:center">‚ö°</div>
                    <div style="height:56px;border-radius:12px;background:var(--card-2);display:flex;align-items:center;justify-content:center">üéØ</div>
                    <div style="height:56px;border-radius:12px;background:var(--card-2);display:flex;align-items:center;justify-content:center;opacity:.45">üîí</div>
                </div>
            </div>
        </aside>
        <main style="display:grid;gap:24px">
            <section id="edit-profile" class="card" style="background:var(--card);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)">
                <div class="sec-head" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
                    <h2 style="margin:0">Edit Profile</h2>
                </div>

                <div th:if="${param.updated}" class="alert" style="background:#e8ffef;color:#036b26;padding:10px;border-radius:8px;margin-bottom:12px">
                    Profile updated successfully
                </div>

                <form th:action="@{/dashboard/edit}" method="post" enctype="multipart/form-data" class="profile-edit" th:object="${user}">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px">
                        <div class="input-group">
                            <label for="location">Country</label>
                            <select id="location" name="location" th:value="*{location}"
                                    style="padding:10px 12px;border-radius:10px;border:1px solid var(--line);background:#0e1012;color:var(--text);font-size:.95rem">
                                <option value="" th:selected="${user.location == null || user.location == ''}">Select country</option>
                                <option th:each="c : ${countries}"
                                        th:value="${c.code}"
                                        th:selected="${#strings.equalsIgnoreCase(user.location, c.code)}"
                                        th:text="${c.flag + ' ' + c.name}">Country</option>
                            </select>
                        </div>
                        <div class="input-group">
                            <label for="birthDate">Birth date</label>
                            <input id="birthDate" name="birthDate" type="date" th:value="*{birthDate}">
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="bio">Bio</label>
                        <textarea id="bio" name="bio" rows="3" th:text="*{bio}" placeholder="Tell others about you" style="resize:vertical"></textarea>
                    </div>

                    <div class="input-group">
                        <label style="display:flex;align-items:center;gap:10px;cursor:pointer">
                            <input type="checkbox" name="profilePrivate" th:checked="*{profilePrivate}"
                                   style="width:18px;height:18px;cursor:pointer;accent-color:var(--accent)">
                            <span>Make my profile private (hides XP, country, and age from other users)</span>
                        </label>
                        <div style="color:var(--muted);font-size:12px;margin-top:6px;margin-left:28px">
                            Your username, avatar, level, and bio will always be public.
                        </div>
                    </div>


                    <div style="display:flex;gap:10px;justify-content:flex-end">
                        <button type="submit" class="gt-btn">Save changes</button>
                    </div>
                </form>
            </section>

            <section class="card" style="background:var(--card);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow)">
                <div class="sec-head" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px">
                    <h2 style="margin:0">Quick Links</h2>
                </div>
                <div style="display:flex;gap:12px;flex-wrap:wrap">
                    <a class="gt-btn" href="#">Create Challenge</a>
                    <a class="gt-btn ghost" href="#">My Results</a>
                    <a class="gt-btn ghost" href="#">Badges</a>
                    <a class="gt-btn ghost" href="#">Account Security</a>
                </div>
            </section>
        </main>
    </div>
</section>


</body>
</html>
